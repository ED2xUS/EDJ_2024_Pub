<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bolus Calc Advanced</title>
    <link rel="shortcut icon" href="https://beetusbot.herokuapp.com/images/favicon.ico">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://beetusbot.herokuapp.com/css/boluscalcstyle.css">
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <!--<script src="https://beetusbot.herokuapp.com/js/bootstrap.min.js"></script>-->
    <script type="text/javascript" src="https://beetusbot.herokuapp.com/js/jquery.ajax-cross-origin.min.js"></script>
    <script type="text/javascript" src="https://beetusbot.herokuapp.com/js/setup.js"></script>
    <script type="text/javascript" src="https://beetusbot.herokuapp.com/js/processdata.js"></script>
    <script type="text/javascript" src="https://beetusbot.herokuapp.com/js/calculators.js"></script>
    <script type="text/javascript" src="https://beetusbot.herokuapp.com/js/processform.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {

            // ~~~~~~~~~~~~~~~~~~~~~~~~~ RUN FUNCTIONS ON PAGE LOAD ~~~~~~~~~~~~~~~~~~~~~~~~~

            getDate();

            getCustomJSON(profileURL, "profile", function(returndata) {
                if (returndata == "Error pulling stats") {
                    document.getElementById("errors").innerHTML = returndata + " - Profile";
                } else {
                    getCustomJSON(entriesURL + "?count=12", "BG", function(returndata) {
                        if (returndata != "Error pulling stats") {
                            trendText = BGtrends();
                            document.getElementById("resultsBG").innerHTML = trendText;
                            getCustomJSON(treatmentsURL, "Treatments", function(returndata) {
                                if (returndata != "Error pulling stats") {
                                    treatmentsArray = returndata;
                                    var treatmentString = processTreatments(treatmentsArray);
                                    prevString = document.getElementById("resultsBG").innerHTML;
                                    document.getElementById("resultsBG").innerHTML = prevString.substring(0, prevString.length - 2) + treatmentString;
                                    bolusCalc();
                                } else {
                                    document.getElementById("errors").innerHTML = returndata + " - Treatments";
                                }
                            });
                        } else {
                            document.getElementById("errors").innerHTML = returndata + " - Entries";
                        }
                    });
                }
            });

            setButtonActions();

        });
    </script>

</head>

<body>

    <div id="statusdiv" class="alt1">
        <b>Current Stats</b><br/>
        <div id="resultsBG">BG: --<br/>30 min delta: --<br/>60 min delta: --<br/>Time since last meal/snack: --
        </div>
    </div>

    <div id="mealdiv" class="alt2">
        <b>Meal or Snack</b><br/>
        <form id="mealform">
            Load meal:<br/>
            <select id="prebolus">
	  <option value="0" selected="selected">0</option>
	  <option value="5">5</option>
		<option value="10">10</option>
		<option value="15">15</option>
		<option value="20">20</option>
		<option value="25">25</option>
		<option value="30">30</option>
		<option value="35">35</option>
		<option value="40">40</option>
		<option value="45">45</option>
		<option value="50">50</option>
		<option value="55">55</option>
		<option value="60">60</option>
	</select> Carb time<br/>
            <div class="columnwrap">
                <div class="leftcolumn">
                    <input id="BreakfastButton" type="button" value="Breakfast" /><br/>
                    <input id="LunchButton" type="button" value="Lunch" /><br/>
                    <input id="DinnerButton" type="button" value="Dinner" />
                </div>
                <div class="rightcolumn">
                    <input id="MornSnackButton" type="button" value="Morning Snack" /><br/>
                    <input id="AftSnackButton" type="button" value="Afternoon Snack" /><br/>
                    <input id="EveSnackButton" type="button" value="Evening Snack" />
                </div>
            </div>
            <br/> Results:
            <br/>
            <input type="number" step="0.1" id="carbs" placeholder="Grams" min="0" value="0" /> Carbs<br/>
            <input type="number" step="0.1" id="fat" placeholder="Grams" min="0" value="0" /> Fat<br/>
            <input type="number" step="0.1" id="protein" placeholder="Grams" min="0" value="0" /> Protein<br/>
            <input type="number" step="0.1" id="fiber" placeholder="Grams" min="0" value="0" /> Fiber<br/><br/>

            <!--<input type="button" id="TestButton" value="Process Test Data" /><br/><br/>-->
            <input type="button" id="suggest_meal" value="Manual entry" /><br/>
            <div id="results_meal"></div>
            <div id="results_mealdose">
                <input type="number" step="0.01" id="carbdose_meal" min="0" value="0" /> Food Now <input type="button" id="carbdose_clear" value="Clear" class="clear" />
                <br/><input type="number" step="0.01" id="extdose_meal" min="0" value="0" /> Food Extended <input type="button" id="extdose_clear" value="Clear" class="clear" />
                <br/><input type="number" step="0.01" id="corrdose_meal" value="0" /> Correction <input type="button" id="corrdose_clear" value="Clear" class="clear" />
                <br/><input type="number" step="0.01" id="super_meal" min="0" value="0" /> Super <input type="button" id="superdose_clear" value="Clear" class="clear" />
                <br/><input type="number" step="1" id="bolusnow_meal" min="0" value="100" style="width: 22%;" />%<input type="number" step="1" id="bolusext_meal" min="0" value="0" style="width: 22%;" />% Combo split <input type="button" id="combosplit_clear"
                    value="Clear" class="clear" />
                <br/><select id="extBolusTime"><input type="button" id="subtract_25" value="-25%" class="clear" />
		<option value="0">N/A</option>    
	  	<option value="30">30 mins</option>
	  	<option value="60">1 hr</option>
		<option value="90" selected="selected">1.5 hrs</option>
		<option value="120">2 hrs</option>
		<option value="150">2.5 hrs</option>
		<option value="180">3 hrs</option>
		<option value="210">3.5 hrs</option>
		<option value="240">4 hrs</option>
		<option value="270">4.5 hrs</option>
		<option value="300">5 hrs</option>
		<option value="330">5.5 hrs</option>
		<option value="360">6 hrs</option>
	</select> Ext bolus time<br/>
                <input type="submit" id="submit_meal" value="Submit meal/snack" /><br/>
            </div>
        </form>
        <div id="submission_meal"></div>

    </div>

    <div id="correctiondiv" class="alt1">
        <b>Correction Only</b><br/>
        <form id="correctionform">
            <input type="number" step="0.1" id="corrCarbs" min="0" value="0" /> Carbs<br/>
            <input type="number" id="corrdose" step="0.01" min="0" value="0" /> Units<br/>
            <input type="submit" id="submit_correction" value="Submit correction" />
        </form>
        <div id="submission_correction"></div>
        <div id="results_correction"></div>
    </div>

    <div id="tempbasaldiv" class="alt2">
        <b>Temp Basal</b><br/>
        <form id="tempbasalform">
            <input type="number" id="basalduration" placeholder="Minutes" min="0" /> Duration<br/>
            <input type="number" id="basalpercent" placeholder="Basal change in %" min="-100" /> % Change<br/>
            <div class="columnwrap">
                <div class="leftcolumn">
                    <input type="button" id="EngineBraking" value="Engine braking" /><br/>
                    <input type="submit" id="submit_tempbasal" value="Submit" />
                </div>
                <div class="rightcolumn">
                    <input type="button" id="SuperBolus" value="Super bolus" />
                </div>
            </div>
        </form>
        <div id="submission_tempbasal"></div>
    </div>

    <div id="exercisediv" class="alt1">
        <b>Exercise</b><br/>
        <form id="exerciseform">
            <input type="number" id="exerciseduration" placeholder="Minutes" min="0" /> Duration<br/>
            <input type="time" id="exercisestarttime" /> Start time<br/>
            <div class="columnwrap">
                <div class="leftcolumn">
                    <input type="button" id="Dance" value="Dance" /><br/>
                    <input type="submit" id="ExerciseSubmit" value="Submit" />
                </div>
                <div class="rightcolumn">
                    <input type="button" id="Yoga" value="Yoga" /><br/>
                    <input type="button" id="Other" value="Other" />
                </div>
            </div>

        </form>
        <div id="submission_exercise"></div>
    </div>

    <div id="removepumpdiv" class="alt2">
        <b>Remove Pump</b><br/>
        <form id="removepumpform">
            <input type="number" id="pumpoffduration" placeholder="Minutes" min="0" /> Duration<br/>
            <input type="submit" id="RemovePump" value="Submit" />
        </form>
        <div id="submission_removepump"></div>
    </div>

    <div id="errors"></div>

</body>

</html>